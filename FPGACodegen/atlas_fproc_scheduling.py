#-------------------------------------------------------------------------------
# Limb 1
#-------------------------------------------------------------------------------
L1_ID_par     = ["nop","back_bky","back_bkz","l_leg_hpz","l_leg_hpx","l_leg_hpy","l_leg_kny","l_leg_aky"]

L1_ID_name    = ["back_bky","back_bkz","l_leg_hpz","l_leg_hpx","l_leg_hpy","l_leg_kny","l_leg_aky","l_leg_akx"]

L1_ID_dist    = [9,8,7,6,5,4,3,2]

L1_dL1_0_par  = ["nop","back_bky","back_bkz","l_leg_hpz","l_leg_hpx","l_leg_hpy","l_leg_kny","l_leg_aky"]
L1_dL1_1_par  = ["back_bky","back_bkz","l_leg_hpz","l_leg_hpx","l_leg_hpy","l_leg_kny","l_leg_aky"]
L1_dL1_2_par  = ["back_bkz","l_leg_hpz","l_leg_hpx","l_leg_hpy","l_leg_kny","l_leg_aky"]
L1_dL1_3_par  = ["l_leg_hpz","l_leg_hpx","l_leg_hpy","l_leg_kny","l_leg_aky"]
L1_dL1_4_par  = ["l_leg_hpx","l_leg_hpy","l_leg_kny","l_leg_aky"]
L1_dL1_5_par  = ["l_leg_hpy","l_leg_kny","l_leg_aky"]
L1_dL1_6_par  = ["l_leg_kny","l_leg_aky"]
L1_dL1_7_par  = ["l_leg_aky"]

L1_dL1_0_name = ["back_bky","back_bkz","l_leg_hpz","l_leg_hpx","l_leg_hpy","l_leg_kny","l_leg_aky","l_leg_akx"]
L1_dL1_1_name = ["back_bkz","l_leg_hpz","l_leg_hpx","l_leg_hpy","l_leg_kny","l_leg_aky","l_leg_akx"]
L1_dL1_2_name = ["l_leg_hpz","l_leg_hpx","l_leg_hpy","l_leg_kny","l_leg_aky","l_leg_akx"]
L1_dL1_3_name = ["l_leg_hpx","l_leg_hpy","l_leg_kny","l_leg_aky","l_leg_akx"]
L1_dL1_4_name = ["l_leg_hpy","l_leg_kny","l_leg_aky","l_leg_akx"]
L1_dL1_5_name = ["l_leg_kny","l_leg_aky","l_leg_akx"]
L1_dL1_6_name = ["l_leg_aky","l_leg_akx"]
L1_dL1_7_name = ["l_leg_akx"]

L1_dL1_0_derv = ["back_bky","back_bky","back_bky","back_bky","back_bky","back_bky","back_bky","back_bky"]
L1_dL1_1_derv = ["back_bkz","back_bkz","back_bkz","back_bkz","back_bkz","back_bkz","back_bkz"]
L1_dL1_2_derv = ["l_leg_hpz","l_leg_hpz","l_leg_hpz","l_leg_hpz","l_leg_hpz","l_leg_hpz"]
L1_dL1_3_derv = ["l_leg_hpx","l_leg_hpx","l_leg_hpx","l_leg_hpx","l_leg_hpx"]
L1_dL1_4_derv = ["l_leg_hpy","l_leg_hpy","l_leg_hpy","l_leg_hpy"]
L1_dL1_5_derv = ["l_leg_kny","l_leg_kny","l_leg_kny"]
L1_dL1_6_derv = ["l_leg_aky","l_leg_aky"]
L1_dL1_7_derv = ["l_leg_akx"]

L1_dL1_0_dist = [8,7,6,5,4,3,2,1]
L1_dL1_1_dist = [7,6,5,4,3,2,1]
L1_dL1_2_dist = [6,5,4,3,2,1]
L1_dL1_3_dist = [5,4,3,2,1]
L1_dL1_4_dist = [4,3,2,1]
L1_dL1_5_dist = [3,2,1]
L1_dL1_6_dist = [2,1]
L1_dL1_7_dist = [1]

#-------------------------------------------------------------------------------
# Limb 2
#-------------------------------------------------------------------------------
L2_ID_par     = ["back_bkz","r_leg_hpz","r_leg_hpx","r_leg_hpy","r_leg_kny","r_leg_aky"]

L2_ID_name    = ["r_leg_hpz","r_leg_hpx","r_leg_hpy","r_leg_kny","r_leg_aky","r_leg_akx"]

L2_ID_dist    = [7,6,5,4,3,2]

L2_dL1_0_par  = ["back_bkz","r_leg_hpz","r_leg_hpx","r_leg_hpy","r_leg_kny","r_leg_aky"]
L2_dL1_1_par  = ["back_bkz","r_leg_hpz","r_leg_hpx","r_leg_hpy","r_leg_kny","r_leg_aky"]

L2_dL1_0_name = ["r_leg_hpz","r_leg_hpx","r_leg_hpy","r_leg_kny","r_leg_aky","r_leg_akx"]
L2_dL1_1_name = ["r_leg_hpz","r_leg_hpx","r_leg_hpy","r_leg_kny","r_leg_aky","r_leg_akx"]

L2_dL1_0_derv = ["back_bky","back_bky","back_bky","back_bky","back_bky","back_bky"]
L2_dL1_1_derv = ["back_bkz","back_bkz","back_bkz","back_bkz","back_bkz","back_bkz"]

L2_dL1_0_dist = [6,5,4,3,2,1]
L2_dL1_1_dist = [6,5,4,3,2,1]

L2_dL2_0_par  = ["back_bkz","r_leg_hpz","r_leg_hpx","r_leg_hpy","r_leg_kny","r_leg_aky"]
L2_dL2_1_par  = ["r_leg_hpz","r_leg_hpx","r_leg_hpy","r_leg_kny","r_leg_aky"]
L2_dL2_2_par  = ["r_leg_hpx","r_leg_hpy","r_leg_kny","r_leg_aky"]
L2_dL2_3_par  = ["r_leg_hpy","r_leg_kny","r_leg_aky"]
L2_dL2_4_par  = ["r_leg_kny","r_leg_aky"]
L2_dL2_5_par  = ["r_leg_aky"]

L2_dL2_0_name = ["r_leg_hpz","r_leg_hpx","r_leg_hpy","r_leg_kny","r_leg_aky","r_leg_akx"]
L2_dL2_1_name = ["r_leg_hpx","r_leg_hpy","r_leg_kny","r_leg_aky","r_leg_akx"]
L2_dL2_2_name = ["r_leg_hpy","r_leg_kny","r_leg_aky","r_leg_akx"]
L2_dL2_3_name = ["r_leg_kny","r_leg_aky","r_leg_akx"]
L2_dL2_4_name = ["r_leg_aky","r_leg_akx"]
L2_dL2_5_name = ["r_leg_akx"]

L2_dL2_0_derv = ["r_leg_hpz","r_leg_hpz","r_leg_hpz","r_leg_hpz","r_leg_hpz","r_leg_hpz"]
L2_dL2_1_derv = ["r_leg_hpx","r_leg_hpx","r_leg_hpx","r_leg_hpx","r_leg_hpx"]
L2_dL2_2_derv = ["r_leg_hpy","r_leg_hpy","r_leg_hpy","r_leg_hpy"]
L2_dL2_3_derv = ["r_leg_kny","r_leg_kny","r_leg_kny"]
L2_dL2_4_derv = ["r_leg_aky","r_leg_aky"]
L2_dL2_5_derv = ["r_leg_akx"]

L2_dL2_0_dist = [6,5,4,3,2,1]
L2_dL2_1_dist = [5,4,3,2,1]
L2_dL2_2_dist = [4,3,2,1]
L2_dL2_3_dist = [3,2,1]
L2_dL2_4_dist = [2,1]
L2_dL2_5_dist = [1]

#-------------------------------------------------------------------------------
# Limb 3
#-------------------------------------------------------------------------------
L3_ID_par     = ["nop","back_bkx","l_arm_shz","l_arm_shx","l_arm_ely","l_arm_elx","l_arm_uwy","l_arm_mwx"]

L3_ID_name    = ["back_bkx","l_arm_shz","l_arm_shx","l_arm_ely","l_arm_elx","l_arm_uwy","l_arm_mwx","l_arm_lwy"]

L3_ID_dist    = [9,8,7,6,5,4,3,2]

L3_dL3_0_par  = ["nop","back_bkx","l_arm_shz","l_arm_shx","l_arm_ely","l_arm_elx","l_arm_uwy","l_arm_mwx"]
L3_dL3_1_par  = ["back_bkx","l_arm_shz","l_arm_shx","l_arm_ely","l_arm_elx","l_arm_uwy","l_arm_mwx"]
L3_dL3_2_par  = ["l_arm_shz","l_arm_shx","l_arm_ely","l_arm_elx","l_arm_uwy","l_arm_mwx"]
L3_dL3_3_par  = ["l_arm_shx","l_arm_ely","l_arm_elx","l_arm_uwy","l_arm_mwx"]
L3_dL3_4_par  = ["l_arm_ely","l_arm_elx","l_arm_uwy","l_arm_mwx"]
L3_dL3_5_par  = ["l_arm_elx","l_arm_uwy","l_arm_mwx"]
L3_dL3_6_par  = ["l_arm_uwy","l_arm_mwx"]
L3_dL3_7_par  = ["l_arm_mwx"]

L3_dL3_0_name = ["back_bkx","l_arm_shz","l_arm_shx","l_arm_ely","l_arm_elx","l_arm_uwy","l_arm_mwx","l_arm_lwy"]
L3_dL3_1_name = ["l_arm_shz","l_arm_shx","l_arm_ely","l_arm_elx","l_arm_uwy","l_arm_mwx","l_arm_lwy"]
L3_dL3_2_name = ["l_arm_shx","l_arm_ely","l_arm_elx","l_arm_uwy","l_arm_mwx","l_arm_lwy"]
L3_dL3_3_name = ["l_arm_ely","l_arm_elx","l_arm_uwy","l_arm_mwx","l_arm_lwy"]
L3_dL3_4_name = ["l_arm_elx","l_arm_uwy","l_arm_mwx","l_arm_lwy"]
L3_dL3_5_name = ["l_arm_uwy","l_arm_mwx","l_arm_lwy"]
L3_dL3_6_name = ["l_arm_mwx","l_arm_lwy"]
L3_dL3_7_name = ["l_arm_lwy"]

L3_dL3_0_derv = ["back_bkx","back_bkx","back_bkx","back_bkx","back_bkx","back_bkx","back_bkx","back_bkx"]
L3_dL3_1_derv = ["l_arm_shz","l_arm_shz","l_arm_shz","l_arm_shz","l_arm_shz","l_arm_shz","l_arm_shz"]
L3_dL3_2_derv = ["l_arm_shx","l_arm_shx","l_arm_shx","l_arm_shx","l_arm_shx","l_arm_shx"]
L3_dL3_3_derv = ["l_arm_ely","l_arm_ely","l_arm_ely","l_arm_ely","l_arm_ely"]
L3_dL3_4_derv = ["l_arm_elx","l_arm_elx","l_arm_elx","l_arm_elx"]
L3_dL3_5_derv = ["l_arm_uwy","l_arm_uwy","l_arm_uwy"]
L3_dL3_6_derv = ["l_arm_mwx","l_arm_mwx"]
L3_dL3_7_derv = ["l_arm_lwy"]

L3_dL3_0_dist = [8,7,6,5,4,3,2,1]
L3_dL3_1_dist = [7,6,5,4,3,2,1]
L3_dL3_2_dist = [6,5,4,3,2,1]
L3_dL3_3_dist = [5,4,3,2,1]
L3_dL3_4_dist = [4,3,2,1]
L3_dL3_5_dist = [3,2,1]
L3_dL3_6_dist = [2,1]
L3_dL3_7_dist = [1]

#-------------------------------------------------------------------------------
# Limb 4
#-------------------------------------------------------------------------------
L4_ID_par     = ["back_bkx","r_arm_shz","r_arm_shx","r_arm_ely","r_arm_elx","r_arm_uwy","r_arm_mwx"]

L4_ID_name    = ["r_arm_shz","r_arm_shx","r_arm_ely","r_arm_elx","r_arm_uwy","r_arm_mwx","r_arm_lwy"]

L4_ID_dist    = [8,7,6,5,4,3,2]

L4_dL3_0_par  = ["back_bkx","r_arm_shz","r_arm_shx","r_arm_ely","r_arm_elx","r_arm_uwy","r_arm_mwx"]

L4_dL3_0_name = ["r_arm_shz","r_arm_shx","r_arm_ely","r_arm_elx","r_arm_uwy","r_arm_mwx","r_arm_lwy"]

L4_dL3_0_derv = ["back_bkx","back_bkx","back_bkx","back_bkx","back_bkx","back_bkx","back_bkx"]

L4_dL3_0_dist = [7,6,5,4,3,2,1]

L4_dL4_0_par  = ["back_bkx","r_arm_shz","r_arm_shx","r_arm_ely","r_arm_elx","r_arm_uwy","r_arm_mwx"]
L4_dL4_1_par  = ["r_arm_shz","r_arm_shx","r_arm_ely","r_arm_elx","r_arm_uwy","r_arm_mwx"]
L4_dL4_2_par  = ["r_arm_shx","r_arm_ely","r_arm_elx","r_arm_uwy","r_arm_mwx"]
L4_dL4_3_par  = ["r_arm_ely","r_arm_elx","r_arm_uwy","r_arm_mwx"]
L4_dL4_4_par  = ["r_arm_elx","r_arm_uwy","r_arm_mwx"]
L4_dL4_5_par  = ["r_arm_uwy","r_arm_mwx"]
L4_dL4_6_par  = ["r_arm_mwx"]

L4_dL4_0_name = ["r_arm_shz","r_arm_shx","r_arm_ely","r_arm_elx","r_arm_uwy","r_arm_mwx","r_arm_lwy"]
L4_dL4_1_name = ["r_arm_shx","r_arm_ely","r_arm_elx","r_arm_uwy","r_arm_mwx","r_arm_lwy"]
L4_dL4_2_name = ["r_arm_ely","r_arm_elx","r_arm_uwy","r_arm_mwx","r_arm_lwy"]
L4_dL4_3_name = ["r_arm_elx","r_arm_uwy","r_arm_mwx","r_arm_lwy"]
L4_dL4_4_name = ["r_arm_uwy","r_arm_mwx","r_arm_lwy"]
L4_dL4_5_name = ["r_arm_mwx","r_arm_lwy"]
L4_dL4_6_name = ["r_arm_lwy"]

L4_dL4_0_derv = ["r_arm_shz","r_arm_shz","r_arm_shz","r_arm_shz","r_arm_shz","r_arm_shz","r_arm_shz"]
L4_dL4_1_derv = ["r_arm_shx","r_arm_shx","r_arm_shx","r_arm_shx","r_arm_shx","r_arm_shx"]
L4_dL4_2_derv = ["r_arm_ely","r_arm_ely","r_arm_ely","r_arm_ely","r_arm_ely"]
L4_dL4_3_derv = ["r_arm_elx","r_arm_elx","r_arm_elx","r_arm_elx"]
L4_dL4_4_derv = ["r_arm_uwy","r_arm_uwy","r_arm_uwy"]
L4_dL4_5_derv = ["r_arm_mwx","r_arm_mwx"]
L4_dL4_6_derv = ["r_arm_lwy"]

L4_dL4_0_dist = [7,6,5,4,3,2,1]
L4_dL4_1_dist = [6,5,4,3,2,1]
L4_dL4_2_dist = [5,4,3,2,1]
L4_dL4_3_dist = [4,3,2,1]
L4_dL4_4_dist = [3,2,1]
L4_dL4_5_dist = [2,1]
L4_dL4_6_dist = [1]

#-------------------------------------------------------------------------------
# Limb 5
#-------------------------------------------------------------------------------
L5_ID_par     = ["back_bkx"]

L5_ID_name    = ["neck_ay"]

L5_ID_dist    = [2]

L5_dL3_0_par  = ["back_bkx"]

L5_dL3_0_name = ["neck_ay"]

L5_dL3_0_derv = ["back_bkx"]

L5_dL3_0_dist = [1]

L5_dL5_0_par  = ["back_bkx"]

L5_dL5_0_name = ["neck_ay"]

L5_dL5_0_derv = ["back_bkx"]

L5_dL5_0_dist = [1]

#-------------------------------------------------------------------------------
# Data Structures
#-------------------------------------------------------------------------------
all_ID_par_lists  = [L1_ID_par,L2_ID_par,L3_ID_par,L4_ID_par,L5_ID_par]
all_ID_name_lists = [L1_ID_name,L2_ID_name,L3_ID_name,L4_ID_name,L5_ID_name]
all_ID_dist_lists = [L1_ID_dist,L2_ID_dist,L3_ID_dist,L4_ID_dist,L5_ID_dist]

all_GradID_par_lists  = [L1_dL1_0_par,L1_dL1_1_par,L1_dL1_2_par,L1_dL1_3_par,L1_dL1_4_par,L1_dL1_5_par,L1_dL1_6_par,L1_dL1_7_par,\
                         L2_dL1_0_par,L2_dL1_1_par,\
                         L2_dL2_0_par,L2_dL2_1_par,L2_dL2_2_par,L2_dL2_3_par,L2_dL2_4_par,L2_dL2_5_par,\
                         L3_dL3_0_par,L3_dL3_1_par,L3_dL3_2_par,L3_dL3_3_par,L3_dL3_4_par,L3_dL3_5_par,L3_dL3_6_par,L3_dL3_7_par,\
                         L4_dL3_0_par,\
                         L4_dL4_0_par,L4_dL4_1_par,L4_dL4_2_par,L4_dL4_3_par,L4_dL4_4_par,L4_dL4_5_par,L4_dL4_6_par,\
                         L5_dL3_0_par,\
                         L5_dL5_0_par]
all_GradID_name_lists = [L1_dL1_0_name,L1_dL1_1_name,L1_dL1_2_name,L1_dL1_3_name,L1_dL1_4_name,L1_dL1_5_name,L1_dL1_6_name,L1_dL1_7_name,\
                         L2_dL1_0_name,L2_dL1_1_name,\
                         L2_dL2_0_name,L2_dL2_1_name,L2_dL2_2_name,L2_dL2_3_name,L2_dL2_4_name,L2_dL2_5_name,\
                         L3_dL3_0_name,L3_dL3_1_name,L3_dL3_2_name,L3_dL3_3_name,L3_dL3_4_name,L3_dL3_5_name,L3_dL3_6_name,L3_dL3_7_name,\
                         L4_dL3_0_name,\
                         L4_dL4_0_name,L4_dL4_1_name,L4_dL4_2_name,L4_dL4_3_name,L4_dL4_4_name,L4_dL4_5_name,L4_dL4_6_name,\
                         L5_dL3_0_name,\
                         L5_dL5_0_name]
all_GradID_derv_lists = [L1_dL1_0_derv,L1_dL1_1_derv,L1_dL1_2_derv,L1_dL1_3_derv,L1_dL1_4_derv,L1_dL1_5_derv,L1_dL1_6_derv,L1_dL1_7_derv,\
                         L2_dL1_0_derv,L2_dL1_1_derv,\
                         L2_dL2_0_derv,L2_dL2_1_derv,L2_dL2_2_derv,L2_dL2_3_derv,L2_dL2_4_derv,L2_dL2_5_derv,\
                         L3_dL3_0_derv,L3_dL3_1_derv,L3_dL3_2_derv,L3_dL3_3_derv,L3_dL3_4_derv,L3_dL3_5_derv,L3_dL3_6_derv,L3_dL3_7_derv,\
                         L4_dL3_0_derv,\
                         L4_dL4_0_derv,L4_dL4_1_derv,L4_dL4_2_derv,L4_dL4_3_derv,L4_dL4_4_derv,L4_dL4_5_derv,L4_dL4_6_derv,\
                         L5_dL3_0_derv,\
                         L5_dL5_0_derv]
all_GradID_dist_lists = [L1_dL1_0_dist,L1_dL1_1_dist,L1_dL1_2_dist,L1_dL1_3_dist,L1_dL1_4_dist,L1_dL1_5_dist,L1_dL1_6_dist,L1_dL1_7_dist,\
                         L2_dL1_0_dist,L2_dL1_1_dist,\
                         L2_dL2_0_dist,L2_dL2_1_dist,L2_dL2_2_dist,L2_dL2_3_dist,L2_dL2_4_dist,L2_dL2_5_dist,\
                         L3_dL3_0_dist,L3_dL3_1_dist,L3_dL3_2_dist,L3_dL3_3_dist,L3_dL3_4_dist,L3_dL3_5_dist,L3_dL3_6_dist,L3_dL3_7_dist,\
                         L4_dL3_0_dist,\
                         L4_dL4_0_dist,L4_dL4_1_dist,L4_dL4_2_dist,L4_dL4_3_dist,L4_dL4_4_dist,L4_dL4_5_dist,L4_dL4_6_dist,\
                         L5_dL3_0_dist,\
                         L5_dL5_0_dist]

#-------------------------------------------------------------------------------
# Scheduling based on Hu's Algorithm
#-------------------------------------------------------------------------------
num_PEs = 7

# Initialize bookkeeping
completed_ID_node_par_list  = ["nop"]
completed_ID_node_name_list = ["nop"]
completed_ID_node_dist_list = [0]
all_ID_nodes_scheduled = False

allPEs_completed_GradID_node_par_list  = []
allPEs_completed_GradID_node_name_list = []
allPEs_completed_GradID_node_derv_list = []
allPEs_completed_GradID_node_dist_list = []
for PE_id in range(0,num_PEs):
   allPEs_completed_GradID_node_par_list.append(["nop"])
   allPEs_completed_GradID_node_name_list.append(["nop"])
   allPEs_completed_GradID_node_derv_list.append(["nop"])
   allPEs_completed_GradID_node_dist_list.append([0])
all_GradID_nodes_scheduled = False

while ((all_ID_nodes_scheduled == False)|(all_GradID_nodes_scheduled == False)):
   # Find the ID list with the node with max dist
   curr_max_ID_dist = 0
   curr_max_dist_ID_list_index = 0
   for ID_list_index,ID_list in enumerate(all_ID_name_lists):
      if (len(ID_list) != 0):
         ID_list_par  = all_ID_par_lists[ID_list_index]
         ID_list_name = all_ID_name_lists[ID_list_index]
         ID_list_dist = all_ID_dist_lists[ID_list_index]
         ID_node_par  = ID_list_par[0]
         ID_node_name = ID_list_name[0]
         ID_node_dist = ID_list_dist[0]
         ###print("ID: (",ID_node_par,",",ID_node_name,",",ID_node_dist,")")
         if (ID_node_dist > curr_max_ID_dist):
            prereqs_met = False
            # Check that the prereqs are met
            for completed_ID_node_name in completed_ID_node_name_list:
               if (completed_ID_node_name == ID_node_par):
                  prereqs_met = True
            if (prereqs_met == True):
               # Save the node info
               curr_max_ID_dist = ID_list_dist[0]
               curr_max_dist_ID_list_index = ID_list_index
   ###if (curr_max_ID_dist == 0):
      ###print("Error: No Max ID Dist found. Current Max ID Dist:",curr_max_ID_dist,"List Index:",curr_max_dist_ID_list_index)
   ###else:
      ###print("Max ID Dist Found: Current Max ID Dist:",curr_max_ID_dist,"List Index:",curr_max_dist_ID_list_index)

   # Schedule as many GradGradID nodes as possible with the max dists
   for PE_id in range(0,num_PEs):
      # Find the GradID list with the node with max dist
      curr_max_GradID_dist = 0
      curr_max_dist_GradID_list_index = 0
      for GradID_list_index,GradID_list in enumerate(all_GradID_name_lists):
         if (len(GradID_list) != 0):
            GradID_list_par  = all_GradID_par_lists[GradID_list_index]
            GradID_list_name = all_GradID_name_lists[GradID_list_index]
            GradID_list_derv = all_GradID_derv_lists[GradID_list_index]
            GradID_list_dist = all_GradID_dist_lists[GradID_list_index]
            GradID_node_par  = GradID_list_par[0]
            GradID_node_name = GradID_list_name[0]
            GradID_node_derv = GradID_list_derv[0]
            GradID_node_dist = GradID_list_dist[0]
            ###print("GradID: (",GradID_node_par,",",GradID_node_name,",",GradID_node_dist,")")
            if (GradID_node_dist > curr_max_GradID_dist):
               ID_prereqs_met = False
               GradID_prereqs_met = False
               # Check that the ID prereqs are met
               for completed_ID_node_name in completed_ID_node_name_list:
                  if (completed_ID_node_name == GradID_node_name):
                     ID_prereqs_met = True
               # Check that the GradID prereqs are met
               for completed_GradID_node_name_list in allPEs_completed_GradID_node_name_list:
                  for completed_GradID_node_name in completed_GradID_node_name_list:
                     if (completed_GradID_node_name == GradID_node_par):
                        GradID_prereqs_met = True
               if (ID_prereqs_met == True)&(GradID_prereqs_met == True):
                  # Save the node info
                  curr_max_GradID_dist = GradID_list_dist[0]
                  curr_max_dist_GradID_list_index = GradID_list_index
      if (curr_max_GradID_dist == 0):
         ###print("Error: No Max GradID Dist found. Current Max GradID Dist:",curr_max_GradID_dist,"List Index:",curr_max_dist_GradID_list_index)
         # Schedule a NOP for this PE
         completed_GradID_node_par_list  = allPEs_completed_GradID_node_par_list[PE_id]
         completed_GradID_node_name_list = allPEs_completed_GradID_node_name_list[PE_id]
         completed_GradID_node_derv_list = allPEs_completed_GradID_node_derv_list[PE_id]
         completed_GradID_node_dist_list = allPEs_completed_GradID_node_dist_list[PE_id]      
         completed_GradID_node_par_list.append("nop")
         completed_GradID_node_name_list.append("nop")
         completed_GradID_node_derv_list.append("nop")
         completed_GradID_node_dist_list.append(0)
      else:
         ###print("Max GradID Dist Found: Current Max GradID Dist:",curr_max_GradID_dist,"List Index:",curr_max_dist_GradID_list_index)
         # Schedule that GradID node and remove it from its list
         curr_max_dist_GradID_par_list  = all_GradID_par_lists[curr_max_dist_GradID_list_index]
         curr_max_dist_GradID_name_list = all_GradID_name_lists[curr_max_dist_GradID_list_index]
         curr_max_dist_GradID_derv_list = all_GradID_derv_lists[curr_max_dist_GradID_list_index]
         curr_max_dist_GradID_dist_list = all_GradID_dist_lists[curr_max_dist_GradID_list_index]
         curr_max_dist_GradID_node_par  = curr_max_dist_GradID_par_list[0]
         curr_max_dist_GradID_node_name = curr_max_dist_GradID_name_list[0]
         curr_max_dist_GradID_node_derv = curr_max_dist_GradID_derv_list[0]
         curr_max_dist_GradID_node_dist = curr_max_dist_GradID_dist_list[0]
         # Choose a PE and add GradID node to schedule
         completed_GradID_node_par_list  = allPEs_completed_GradID_node_par_list[PE_id]
         completed_GradID_node_name_list = allPEs_completed_GradID_node_name_list[PE_id]
         completed_GradID_node_derv_list = allPEs_completed_GradID_node_derv_list[PE_id]
         completed_GradID_node_dist_list = allPEs_completed_GradID_node_dist_list[PE_id]      
         completed_GradID_node_par_list.append(curr_max_dist_GradID_node_par)
         completed_GradID_node_name_list.append(curr_max_dist_GradID_node_name)
         completed_GradID_node_derv_list.append(curr_max_dist_GradID_node_derv)
         completed_GradID_node_dist_list.append(curr_max_dist_GradID_node_dist)
         # Remove that GradID node from its list
         curr_max_dist_GradID_par_list.pop(0)
         curr_max_dist_GradID_name_list.pop(0)
         curr_max_dist_GradID_derv_list.pop(0)
         curr_max_dist_GradID_dist_list.pop(0)

   # Schedule that ID node and remove it from its list
   if (curr_max_ID_dist != 0):
      curr_max_dist_ID_par_list  = all_ID_par_lists[curr_max_dist_ID_list_index]
      curr_max_dist_ID_name_list = all_ID_name_lists[curr_max_dist_ID_list_index]
      curr_max_dist_ID_dist_list = all_ID_dist_lists[curr_max_dist_ID_list_index]
      curr_max_dist_ID_node_par  = curr_max_dist_ID_par_list[0]
      curr_max_dist_ID_node_name = curr_max_dist_ID_name_list[0]
      curr_max_dist_ID_node_dist = curr_max_dist_ID_dist_list[0]
      completed_ID_node_par_list.append(curr_max_dist_ID_node_par)
      completed_ID_node_name_list.append(curr_max_dist_ID_node_name)
      completed_ID_node_dist_list.append(curr_max_dist_ID_node_dist)
      curr_max_dist_ID_par_list.pop(0)
      curr_max_dist_ID_name_list.pop(0)
      curr_max_dist_ID_dist_list.pop(0)
   
   # Check if all ID nodes scheduled
   all_ID_nodes_scheduled = True
   for ID_list_index,ID_list in enumerate(all_ID_name_lists):
      if (len(ID_list) != 0):
         all_ID_nodes_scheduled = False

   # Check if all GradID nodes scheduled
   all_GradID_nodes_scheduled = True
   for GradID_list_index,GradID_list in enumerate(all_GradID_name_lists):
      if (len(GradID_list) != 0):
         all_GradID_nodes_scheduled = False
         
# Remove the Initial NOPs from the ID schedule lists
completed_ID_node_par_list.pop(0)
completed_ID_node_name_list.pop(0)
completed_ID_node_dist_list.pop(0)

# Remove the Initial NOPs from the GradID schedule lists
for PE_id in range(0,num_PEs):
   completed_GradID_node_par_list  = allPEs_completed_GradID_node_par_list[PE_id]
   completed_GradID_node_name_list = allPEs_completed_GradID_node_name_list[PE_id]
   completed_GradID_node_derv_list = allPEs_completed_GradID_node_derv_list[PE_id]
   completed_GradID_node_dist_list = allPEs_completed_GradID_node_dist_list[PE_id]
   completed_GradID_node_par_list.pop(0)
   completed_GradID_node_name_list.pop(0)
   completed_GradID_node_derv_list.pop(0)
   completed_GradID_node_dist_list.pop(0)

# Print ID schedule lists
###print("ID Parent:  ",completed_ID_node_par_list)
###print("ID Current: ",completed_ID_node_name_list)
###print("ID Distance:",completed_ID_node_dist_list)

# Print GradID schedule lists
###for PE_id in range(0,num_PEs):
   ###print("[PE",PE_id,"] GradID Parent:  ",allPEs_completed_GradID_node_par_list[PE_id])
   ###print("[PE",PE_id,"] GradID Current: ",allPEs_completed_GradID_node_name_list[PE_id])
   ###print("[PE",PE_id,"] GradID Deriv.:  ",allPEs_completed_GradID_node_derv_list[PE_id])
   ###print("[PE",PE_id,"] GradID Distance:",allPEs_completed_GradID_node_dist_list[PE_id])

#-------------------------------------------------------------------------------
# Formatting for BluespecInterfaceGen.py
#-------------------------------------------------------------------------------

# Number link based on Assumed Input Joint Configuration Ordering
joint_config_order_list = ["back_bkz","back_bky","back_bkx","l_arm_shz","l_arm_shx","l_arm_ely","l_arm_elx","l_arm_uwy","l_arm_mwx","l_arm_lwy","neck_ay","r_arm_shz","r_arm_shx","r_arm_ely","r_arm_elx","r_arm_uwy","r_arm_mwx","r_arm_lwy","l_leg_hpz","l_leg_hpx","l_leg_hpy","l_leg_kny","l_leg_aky","l_leg_akx","r_leg_hpz","r_leg_hpx","r_leg_hpy","r_leg_kny","r_leg_aky","r_leg_akx"]
joint_config_order_list.insert(0,"nop")

# While numbering links, search for max schedule length
len_fproc_sched = 0

# Number links for ID lists
for node_index,completed_ID_node_par in enumerate(completed_ID_node_par_list):
   for joint_index,joint_name in enumerate(joint_config_order_list):
      if (completed_ID_node_par == joint_name):
         completed_ID_node_par_list[node_index] = joint_index
for node_index,completed_ID_node_name in enumerate(completed_ID_node_name_list):
   for joint_index,joint_name in enumerate(joint_config_order_list):
      if (completed_ID_node_name == joint_name):
         completed_ID_node_name_list[node_index] = joint_index
len_ID_sched = len(completed_ID_node_name_list)
if (len_ID_sched > len_fproc_sched):
   len_fproc_sched = len_ID_sched

# Number links for ID lists
for PE_id in range(0,num_PEs):
   completed_GradID_node_par_list  = allPEs_completed_GradID_node_par_list[PE_id]
   completed_GradID_node_name_list = allPEs_completed_GradID_node_name_list[PE_id]
   completed_GradID_node_derv_list = allPEs_completed_GradID_node_derv_list[PE_id]
   completed_GradID_node_dist_list = allPEs_completed_GradID_node_dist_list[PE_id]
   for node_index,completed_GradID_node_par in enumerate(completed_GradID_node_par_list):
      for joint_index,joint_name in enumerate(joint_config_order_list):
         if (completed_GradID_node_par == joint_name):
            completed_GradID_node_par_list[node_index] = joint_index
   for node_index,completed_GradID_node_name in enumerate(completed_GradID_node_name_list):
      for joint_index,joint_name in enumerate(joint_config_order_list):
         if (completed_GradID_node_name == joint_name):
            completed_GradID_node_name_list[node_index] = joint_index
   for node_index,completed_GradID_node_derv in enumerate(completed_GradID_node_derv_list):
      for joint_index,joint_name in enumerate(joint_config_order_list):
         if (completed_GradID_node_derv == joint_name):
            completed_GradID_node_derv_list[node_index] = joint_index
   len_GradID_sched = len(completed_GradID_node_name_list)
   if (len_GradID_sched > len_fproc_sched):
      len_fproc_sched = len_GradID_sched

# Print ID schedule lists
print("ID Parent:  ",completed_ID_node_par_list)
print("ID Current: ",completed_ID_node_name_list)
print("ID Distance:",completed_ID_node_dist_list)

# Print GradID schedule lists
for PE_id in range(0,num_PEs):
   print("[PE",PE_id,"] GradID Parent:  ",allPEs_completed_GradID_node_par_list[PE_id])
   print("[PE",PE_id,"] GradID Current: ",allPEs_completed_GradID_node_name_list[PE_id])
   print("[PE",PE_id,"] GradID Deriv.:  ",allPEs_completed_GradID_node_derv_list[PE_id])
   print("[PE",PE_id,"] GradID Distance:",allPEs_completed_GradID_node_dist_list[PE_id])

# Assemble the output lists
fproc_curr_sched = []
fproc_par_sched = []
fproc_derv_sched = []
for row in range(0,len_fproc_sched):
   curr_row = []
   par_row  = []
   derv_row = []
   for PE_id in range(0,num_PEs):
      completed_GradID_node_curr_list = allPEs_completed_GradID_node_name_list[PE_id]
      completed_GradID_node_par_list  = allPEs_completed_GradID_node_par_list[PE_id]
      completed_GradID_node_derv_list = allPEs_completed_GradID_node_derv_list[PE_id]
      curr_row.append(completed_GradID_node_curr_list[0])
      par_row.append(completed_GradID_node_par_list[0])
      derv_row.append(completed_GradID_node_derv_list[0])
      if (len(completed_GradID_node_curr_list) != 0):
         completed_GradID_node_curr_list.pop(0)
         completed_GradID_node_par_list.pop(0)
         completed_GradID_node_derv_list.pop(0)
   fproc_curr_sched.append(curr_row)
   fproc_par_sched.append(par_row)
   fproc_derv_sched.append(derv_row)

# Pad the end of the ID schedules
len_id_sched = len(completed_ID_node_name_list)
padding_cycles = (len_fproc_sched-len_id_sched)
if (padding_cycles > 0):
   for cycle in range(0,padding_cycles):
      completed_ID_node_name_list.append(0)
      completed_ID_node_par_list.append(0)

# Print formatted output
print("sched_table_dict = {")
print("                \"len_fproc_sched\": "+str(len_fproc_sched)+",")
print("                \"rnea_fproc_curr_sched\": "+str(completed_ID_node_name_list)+", ")
print("                \"rnea_fproc_par_sched\":  "+str(completed_ID_node_par_list)+", ")
print("                \"fproc_curr_sched\": [")
for row_id,row in enumerate(fproc_curr_sched):
   if ((row_id+1) < len(fproc_curr_sched)):
      print("                        "+str(row)+",")
   else:
      print("                        "+str(row))
print("                ],")
print("                \"fproc_par_sched\":  [")
for row_id,row in enumerate(fproc_par_sched):
   if ((row_id+1) < len(fproc_par_sched)):
      print("                        "+str(row)+",")
   else:
      print("                        "+str(row))
print("                ],")
print("                \"fproc_derv_sched\": [")
for row_id,row in enumerate(fproc_derv_sched):
   if ((row_id+1) < len(fproc_derv_sched)):
      print("                        "+str(row)+",")
   else:
      print("                        "+str(row))
print("                ],")
print("            }")
